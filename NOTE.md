# プロジェクト理解

このプロジェクト「bakutan-memory-archive」は、名取さなさんのイベントに関するツイートを記録し、イベントの思い出をいつまでも見やすく保つための非公式なプロジェクトです。

## 概念の階層

1. bakutan-memory-archive（プロジェクト全体）
2. EventAlbum（イベントの集合体）
3. Event（一つのイベント、例：「さなのばくたん。」）
4. Stage（イベント内の一つの企画、例：ライブイベント、コラボカフェなど）
5. Chapter（Stageの分割単位、例：楽曲、MCパート、店舗ごとなど）
6. Memory（現在はツイートURL）

## 主要概念

* **Event:** 「さなのばくたん。」のような大規模イベント。
* **Stage:** イベント内の一つの企画（ライブイベントやコラボカフェなど）。イベント内のStageは必ずしも同時に開催されるわけではない。
* **Chapter:** Stageの区分け（ライブイベントでの曲やMCパート、コラボカフェでの特定の場所など）。
* **Memory:** 現在はツイートURL。サードパーティからの他のメディアの収集の難しさから、ツイートのみをサポートする予定。

## システムアーキテクチャ

このプロジェクトはRemixのSPAモードを使用し、GitHub Pagesにデプロイされています。ツイートは`frontend/app/assets`ディレクトリ内のTSファイルに保存され、ページにインポートされます。

## 計画されている運用

* **ツイート収集:** ユーザースクリプトを使用してTwitterの検索結果からツイートを収集し、LocalStorageに保存します。
* **ツイート分類:** ウェブダッシュボードを使用してツイートをEvent、Stage、Chapterに手動で分類します。結果は`frontend/app/assets`ディレクトリ内のTSファイルにエクスポートされます。
* **リリース:** エクスポートされたTSファイルは`frontend/app/assets`ディレクトリに配置されます。`routes/_index.tsx`ファイルは新しいイベントデータをインポートするように更新されます。古いイベントは新しいルート（例：`routes/bakutan2024.tsx`）に移動され、ルートルートは最新のイベントに焦点を当てます。

## 現在の状態

* ツイート収集ユーザースクリプト（`script/MemoryCollector.ts`）は部分的に実装されています。タイムラインの更新を検出するためにMutationObserverを使用していますが、LocalStorageへの保存とツイート分類機能の実装がまだ必要です。
* ツイート分類ダッシュボードはまだ構築されていません。
* ツイートのデータモデルは`script/models.ts`で定義されています。
* `EventPage`コンポーネント（`frontend/app/components/EventPage.tsx`）は、指定されたイベント、ステージ、チャプターのツイートを表示します。イベントデータを`event`というプロップから取得し、現在選択されているステージとチャプターを管理するためにステートを使用します。個々のツイートを表示するために`TweetWrapper`コンポーネントを使用します。
* `TweetWrapper`コンポーネント（`frontend/app/components/TweetWrapper.tsx`）は、`react-tweet`ライブラリの`Tweet`コンポーネントのラッパーです。`tweetId`をプロップとして受け取り、`Tweet`コンポーネントを使用してツイートをレンダリングします。
* `frontend/app/routes/_index.tsx`は「さなのばくたん。2024」イベントを表示します。
* `frontend/app/routes/indexes.tsx`はルートルートへのリンクを提供します。

## 現在のデータ収集方法

現在のツイートデータ（`frontend/app/assets`内のTSファイル）は手動で収集・分類されています。基本的にはTwitterの検索結果からツイートのURLを手動でコピーしてリストアップする方法で作成されています。この作業は非常に時間がかかるため、将来的にはユーザースクリプトとウェブダッシュボードを使って自動化する予定です。

## 今後の課題と展開

* **ツイート収集ユーザースクリプト**と**ツイート分類ダッシュボード**の実装が次のステップです。
* **大量のツイートの表示方法の改善**も優先度の高い課題です。例えば、`frontend/app/assets/2024/bakutan/senseeMade/nuontart.ts`には多数のファンアート（ヌォンタート）ツイートが含まれており、現在は手動で「その1」から「その26」までのチャプターに分割されています。TwitterのツイートIDはSnowflake形式でUnixTimeが算出できるため、時間ごとの区切りを自動的に行う機能の実装が検討されています。
* **EventAlbum**の概念は存在しますが、まだ実装されていません。将来的には`indexes.tsx`が拡張されることで表現される予定です。
* このプロジェクトは**名取さなさんのイベントのみを対象**としており、他のVTuberへの拡張は予定されていません。
